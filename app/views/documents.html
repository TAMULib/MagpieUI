<br/>
<div class="row" ng-controller="DocumentController">

	<!-- ADMINS, MANAGERS AND ANNOTATORS ONLY -->
	<div ng-if="isUser()" class="row" ng-include src="'views/restrictedAccess.html'" ></div>

	<div ng-if="!isUser()" class="col-12">

		<div class="panel panel-default documents-container">			
			
			<div class="panel-heading">
				<h3 class="panel-title">Documents</h3>
			</div>
			
			<div class="panel-body" ng-if="isAnnotator()">
				<table ng-table="tableParams" class="table table-hover table-condensed">					
					<tbody>					
						<tr ng-repeat="doc in $data">
							<td data-title="'Filename'" sortable="'name'">
								{{doc.name}}
							</td>							
							<td data-title="'Status'" sortable="'status'" filter="{ 'status': 'text' }" class="text-center">
								{{doc.status}}
							</td>
							<td data-title="'Annotator'" sortable="'annotator'" class="text-center">								
								<span ng-if="!doc.annotator">
									<button class="btn btn-default" ng-click="updateAnnotator(doc.name, 'Assigned')">
										Claim
									</button>
								</span>								
								<span ng-if="doc.annotator">
									{{doc.annotator}}
								</span>								
							</td>											
						</tr>						
					</tbody>
				</table>
			</div>
			
			<div class="panel-body " ng-if="isAdmin() || isManager()">
			
				<button ng-click="tableParams.sorting({})" class="btn btn-default">Clear sorting</button>&nbsp;&nbsp;
		        <button ng-click="tableParams.filter({})" class="btn btn-default">Clear filter</button><br/><br/>
		        
		        <!-- 
		        <p><strong>Sorting:</strong> {{tableParams.sorting()|json}}
		        <p><strong>Filter:</strong> {{tableParams.filter()|json}}
		         -->
		        		        
				<table ng-table="tableParams" show-filter="true" class="table table-hover table-condensed">					
					<tbody>					
						<tr ng-repeat="doc in $data">							
							<td data-title="'Filename'" sortable="'name'" filter="{ 'name': 'text' }">
								{{doc.name}}
							</td>							
							<td data-title="'Status'" sortable="'status'" filter="{ 'status': 'text' }" class="text-center">
								{{doc.status}}
							</td>							
							<td data-title="'Annotator'" sortable="'annotator'" filter="{ 'annotator': 'text' }" class="text-center">
								<span ng-if="doc.status != 'Accepted' && !doc.annotator && availableAnnotators().length > 0">
									<select ng-model="doc.annotator" ng-change="updateAnnotator(doc.name, 'Assigned', doc.annotator)" class="form-control">
										<option ng-repeat="annotator in availableAnnotators()" value="{{annotator}}">{{annotator.firstName}} {{annotator.lastName}}</option>
									</select>								
								</span>
								<span ng-if="doc.status != 'Accepted' && !doc.annotator && availableAnnotators().length == 0">
									No Annotators
								</span>
								<span ng-if="doc.annotator">
									<span ng-repeat="anotator in availableAnnotators()" ng-if="doc.annotator.indexOf(anotator.uin) > 0">{{anotator.firstName}} {{anotator.lastName}} ({{anotator.uin}})</span>
								</span>
							</td>
							<td data-title="'Action'" class="text-center">
								<a ng-if="doc.status == 'Annotated'" href="annotate/{{doc.name}}/review" class="btn btn-default">Review</a>
								<a ng-if="doc.status == 'Accepted'" href="annotate/{{doc.name}}/view" class="btn btn-default">View</a>									
							</td>
						</tr>
					</tbody>
				</table>
			</div>
			
		</div>

	</div>
</div>
