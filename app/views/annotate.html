<br/>
<div class="row" ng-controller="AnnotateController"> 

	<!-- ADMINS, MANAGERS AND ANNOTATORS ONLY -->
	<div ng-if="isUser()" class="row" ng-include src="'views/restrictedAccess.html'" ></div>

	<div ng-if="!isUser()" class="row">

	
		<div class="notesWarning bg-warning" ng-if="document.notes">Rejection notes: <span class="notesText">{{document.notes}}</span></div>
		
		<div class="col-8 col-lg-8 document-pane">	
			<div role="tabpanel" class="span6">
				<h2>Document</h2>

				<ul class="nav nav-tabs" role="tablist">
					<li role="presentation" class="active"><a href="#txtTab" aria-controls="txtTab" role="tab" data-toggle="tab">Text</a></li>
					<li role="presentation"><a href="#pdfTab" aria-controls="pdfTab" role="tab" data-toggle="tab">PDF</a></li>
				</ul>
				<div class="tab-content">
					<div role="tabpanel" class="tab-pane active" id="txtTab">	
						<div class="well">{{txt}}</div>
					</div>
					<div role="tabpanel" class="tab-pane" id="pdfTab">
						<object data="{{document.pdfUri}}" type="application/pdf" width="100%" height="600"></object>
					</div>
				</div>
			</div>
		</div>
		
		<div>
			<h2>Metadata</h2>

			<form name="metadataForm">
				<span ng-show="requiredFieldsPresent()" class="requiredField">required flield</span>
				<div class="col-4 col-lg-4 metadata-pane">
					<div ng-repeat="field in document.fields" class="row" ng-hide="field.label.profile.hidden">
						<formlabel text="{{field.label.profile.gloss}}" required="{{field.label.profile.required}}"></formlabel>
						<span title="Add metadata field" 
							  ng-if="field.label.profile.repeatable" 
							  ng-click="addMetadataField(field)" 
							  class="glyphicon glyphicon-plus-sign label-add" style="text-decoration: none;">
						</span>
						<span title="Remove metadata field" 
							  ng-if="field.values.length > 1 && field.label.profile.repeatable" 
							  ng-click="removeMetadataField(field)" 
							  class="glyphicon glyphicon-minus-sign label-remove" 
							  style="text-decoration: none;">
						</span>
						<ul class="list-unstyled">
							<li ng-if="field.label.profile.repeatable" ng-repeat="fieldValue in field.values">
							
								<div class="input-group metadata-label" ng-if="field.label.profile.inputType == 'TEXT'">
								  	<span class="input-group-addon" id="basic-addon{{$index+1}}">{{$index+1}}</span>
									<forminput name="{{field.label.profile.gloss}}" 
											   class="form-control" 
											   type="text" 
											   ng-readonly="field.label.profile.readOnly" 
											   ng-model="field.values[$index].value" 
											   typeahead="vocab for vocab in getControlledVocabulary(field.label.name) | filter:$viewValue">
									</forminput>
								</div>
								<div class="input-group metadata-label" ng-if="field.label.profile.inputType == 'TEXTAREA'">
									<span class="input-group-addon" id="basic-addon{{$index+1}}">{{$index+1}}</span>
									<formtextarea name="{{field.label.profile.gloss}}"
									              class="form-control"
									              ng-readonly="metadataLabel.readOnly" 
									              ng-model="field.values[$index].value">
									</formtextarea>
								</div>
							</li>
							<li ng-if="!field.label.profile.repeatable">
								<forminput 	name="{{field.label.profile.gloss}}" 
											ng-if="field.label.profile.inputType == 'TEXT'" 
											class="form-control" 
											ng-readonly="field.label.profile.readOnly" 
											type="text" 
											ng-model="field.values[0].value" 
											typeahead="vocab for vocab in getControlledVocabulary(field.label.name) | filter:$viewValue">
								</forminput>
								<formtextarea name="{{field.label.profile.gloss}}"
											  ng-if="field.label.profile.inputType == 'TEXTAREA'" 
											  class="form-control" 
											  ng-readonly="field.label.profile.readOnly" 
											  ng-model="field.values[0].value">
								</formtextarea>
							</li>
						</ul>	
					</div>

				</div>
				<div class="row">			
					<div ng-if="isAnnotator() || (isManager() && managerAnnotating())" style="float: right;">
						<button class="btn btn-warning" ng-click="requiresCuration(document.name)">
							Requires Curation
						</button>
						<button class="btn btn-primary" ng-click="updateMetadata(document, 'Pending')">
							Save
						</button>
						<button ng-disabled="metadataForm.$invalid" class="btn btn-success" ng-click="submit(document)">
							Submit
						</button>
					</div>
					<div ng-if="isAdmin() || (isManager() && managerReviewing())" style="float: right;">
						<button class="btn btn-warning" ng-click="requiresCuration(document.name)">
							Requires Curation
						</button>

						<modal modal-id="rejectModal" 
							   modal-view="views/modals/rejectModal.html" 
							   modal-btn-classes="btn btn-danger"
							   modal-header-class="modal-header-danger">Reject</modal>
							   
						<button ng-disabled="metadataForm.$invalid" class="btn btn-success" ng-click="accept(document)" >
							Accept
						</button>
					</div>
				</div>
			</form>

		</div>

	</div>

</div>