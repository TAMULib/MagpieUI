
<div class="row" ng-controller="AnnotateController"> 
	<!-- <div class="row" ng-if="document.notes">
		Rejection notes: <span class="text-danger">{{document.notes}}</span>
	</div> -->
	
	<div class="col-8 col-lg-8 document-pane">	
		<div role="tabpanel" class="span6">
			<h2>Document</h2>
			<ul class="nav nav-tabs" role="tablist">
				<li role="presentation" class="active"><a href="#txtTab" aria-controls="txtTab" role="tab" data-toggle="tab">Text</a></li>
				<li role="presentation"><a href="#pdfTab" aria-controls="pdfTab" role="tab" data-toggle="tab">PDF</a></li>
			</ul>
			<div class="tab-content">
				<div role="tabpanel" class="tab-pane active" id="txtTab">	
					<div class="well">{{txt.verbage}}</div>
				</div>
				<div role="tabpanel" class="tab-pane" id="pdfTab">
					<object data="{{pdf.uri}}" type="application/pdf" width="100%" height="600"></object>
				</div>
			</div>
		</div>
	</div>
	
	<div class="col-4 col-lg-4 metadata-pane">
		<h2>Metadata</h2>
		
		<div ng-repeat="metadataLabel in document.metadataLabels" class="row">			
			<h3 style="display:inline-block;">{{metadataLabel.gloss}}</h3>

			<a title="Remove metadata field" ng-if="getMetadataFieldCount(metadataLabel.label) > 1 && metadataLabel.repeatable" ng-click="removeMetadataField(metadataLabel.label)" class="glyphicon glyphicon-minus-sign" style="text-decoration: none;"></a>
			<a title="Add metadata field" ng-if="metadataLabel.repeatable" ng-click="addMetadataField(metadataLabel.label)" class="glyphicon glyphicon-plus-sign" style="text-decoration: none;"></a>

			<ul class="list-unstyled">

				<li ng-if="metadataLabel.repeatable" ng-repeat="metadataField in document.metadata[metadataLabel.label] track by $index">
				
					<label ng-if="metadataLabel.inputType == 'TEXT'">{{$index+1}}:</label>
					<input  class="form-control" ng-if="metadataLabel.inputType == 'TEXT'" type="text" ng-model="document.metadata[metadataLabel.label][$index]"/>

					<textarea  class="form-control" ng-if="metadataLabel.inputType == 'TEXTAREA'" ng-model="document.metadata[metadataLabel.label][$index]" rows="5" cols="25" style="width:100%;"></textarea>
				</li>
				
				<li ng-if="!metadataLabel.repeatable">
					<input  class="form-control" ng-if="metadataLabel.inputType == 'TEXT'" type="text" ng-model="document.metadata[metadataLabel.label][0]"/>

					<textarea class="form-control" ng-if="metadataLabel.inputType == 'TEXTAREA'" ng-model="document.metadata[metadataLabel.label][0]" rows="5" cols="25" style="width:100%;"></textarea>
				</li>
				
			</ul>	
			
		</div>

		<div class="row">			
			<div ng-if="isAnnotator() || (isManager() && managerAnnotating())" style="float: right;">
				<button class="btn btn-default" ng-click="requiresCuration(document.name)">
					Requires Curation
				</button>
				<button class="btn btn-default" ng-click="updateMetadata(document, 'Pending')">
					Save
				</button>
				<button class="btn btn-default" ng-click="submit(document)">
					Submit
				</button>
			</div>
			<div ng-if="isAdmin() || (isManager() && managerReviewing())" style="float: right;">
				<button class="btn btn-default" ng-click="requiresCuration(document.name)">
					Requires Curation
				</button>
				<button class="btn btn-default" ng-click="accept(document)">
					Accept
				</button>
				<button class="btn btn-default" ng-click="reject(document)">
					Reject
				</button>
			</div>
		</div>		
	</div>
	
	<modal id="notesModal" title="Rejection Notes" visible="showModal" style="display:none;">			
		<form role="form">
			<div class="form-group">
				<label>Please indicate which metadata fields need modification: </label>			
				<textarea ng-model="rejectionNotes" rows="4" cols="75" placeholder="Enter notes"></textarea>
				<br/><br/>
				<button class="btn btn-default" ng-click="submitRejection(document, rejectionNotes)">
					Submit
				</button>
				<span ng-if="!rejectionNotes">
					{{validation}}
				</span>
			</div>
		</form>
	</modal>
</div>